(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{176:function(s,a,t){"use strict";t.r(a);var e=t(0),n=Object(e.a)({},(function(){var s=this.$createElement;this._self._c;return this._m(0)}),[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("div",{staticClass:"content"},[t("h1",{attrs:{id:"持续集成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#持续集成"}},[s._v("#")]),s._v(" 持续集成")]),s._v(" "),t("p",[s._v("本文在快速启动，以及配置项，钩子等内容基础上，介绍在CI 环境中完成相关配置部署的一些tips.")]),s._v(" "),t("h3",{attrs:{id:"运行前准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行前准备"}},[s._v("#")]),s._v(" 运行前准备")]),s._v(" "),t("p",[s._v("在运行前，可检查macaca 以及 nosmoke 将要执行的端口上是否已有相关程序，可执行以下指令将对应程序进行清理")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("lsof")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${process-port-which-you-need-to-close}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v("}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -9\n")])])]),t("h3",{attrs:{id:"运行安卓"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行安卓"}},[s._v("#")]),s._v(" 运行安卓")]),s._v(" "),t("p",[s._v("在运行安卓前，先唤起macaca 服务.")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\nmacaca server --verbose -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3554")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n\n")])])]),t("p",[s._v("接着执行对应的nosmoke 指令开始nosmoke 运行.")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("nosmoke -s -c "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${path-of-file}")]),s._v("/crawler.config-android.yml "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        -h "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${path-of-file}")]),s._v("/hooks-android.js "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --server http://localhost:3554 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3564")]),s._v("\n\n")])])]),t("h3",{attrs:{id:"运行ios"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行ios"}},[s._v("#")]),s._v(" 运行iOS")]),s._v(" "),t("p",[s._v("在运行iOS前，先唤起macaca 服务.")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("macaca server --verbose -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3684")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])])]),t("p",[s._v("接着执行对应的nosmoke 指令开始nosmoke 运行.")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("xcrun simctl launch booted com.apple.springboard\nxcrun simctl terminate booted com.apple.test.XCTestWDUITests-Runner\nxcrun simctl terminate booted "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${your-bundle-id}")]),s._v(".-   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bundle id of your current app.")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\nnosmoke   -s --server http://localhost:3684  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n          -h "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${path-of-file}")]),s._v("/hooks-ios.js "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n          -c "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${path-of-file}")]),s._v("/crawler.config-ios.yml "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n          -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3694")]),s._v("\n\n")])])]),t("p",[s._v("在以上指令执行后，该执行路径下会生成对应的reports 路径，可点击并查看运行报告.")]),s._v(" "),t("p",[t("img",{attrs:{src:"/NoSmoke/assets/generated_output.png",alt:""}})])])}],!1,null,null,null);a.default=n.exports}}]);